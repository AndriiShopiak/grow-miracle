# Динамічна система управління продуктами

## Огляд

Система була оптимізована для автоматичного визначення категорій, властивостей та цін продуктів з бази даних. Тепер при додаванні нових продуктів до бази, всі компоненти (фільтри, корзина, відображення) автоматично адаптуються без необхідності рефакторингу коду.

## Ключові зміни

### 1. Утиліти для динамічного визначення властивостей (`src/utils/productUtils.ts`)

Створено набір функцій для автоматичного визначення:

- **Категорій продуктів** - з поля `species`
- **Типів кореневої системи** - з поля `rootSystem`
- **Підщеп** - з поля `rootstock`
- **Термінів дозрівання** - з поля `ripeningTerm`
- **Рівнів морозостійкості** - з поля `frostResistance`
- **Рівнів врожайності** - з поля `yield`
- **Цін продуктів** - з поля `price` з fallback на уніфіковану ціну

### 2. Динамічні фільтри (`src/components/ProductFilter.tsx`)

Фільтри тепер автоматично генерують опції на основі даних з бази:

- Категорії визначаються динамічно
- Всі опції фільтрів створюються автоматично
- Додано нові фільтри: підщепа, термін дозрівання, морозостійкість, врожайність
- Фільтри показуються тільки якщо є відповідні дані

### 3. Оптимізована корзина (`src/components/cart/CartContext.tsx`)

- Автоматичне визначення цін при відновленні з localStorage
- Динамічне оновлення цін на основі поточної бази продуктів
- Зворотна сумісність зі старими даними

### 4. Оновлені компоненти

- **ProductGrid** - використовує динамічні фільтри та ціни
- **DetailRight** - автоматично визначає ціни продуктів
- **CartPage** - працює з динамічними цінами

## Як додати новий продукт

### Приклад додавання нового продукту:

```typescript
{
  id: 36, // Унікальний ID
  title: "Новий сорт груші",
  species: "груша домашня", // Система автоматично визначить категорію "груша"
  ripeningTerm: "пізній, жовтень",
  fruits: "крупні, жовто-зелені, соковиті",
  taste: "солодкий, м'ясистий",
  selfFertility: "самоплідний сорт",
  yield: "дуже висока",
  frostResistance: "висока (до -24 C°)",
  rootstock: "груша лісова", // Автоматично додасться до фільтру підщеп
  rootSystem: "open", // Автоматично додасться до фільтру кореневої системи
  cultivation: {
    planting: "Для посадки потрібне сонячне місце.",
    care: "Дерево невибагливе.",
    bearingPeriod: "Плодоношення на 4-6 рік.",
  },
  image: "/products/36.jpg",
  price: "400 грн/шт", // Автоматично визначиться ціна
}
```

### Що відбувається автоматично:

1. **Категорія** - система визначить "груша" з поля `species`
2. **Фільтри** - автоматично додасться до всіх відповідних фільтрів
3. **Ціна** - автоматично визначиться з поля `price`
4. **Корзина** - буде працювати з новою ціною
5. **Відображення** - продукт з'явиться в каталозі з усіма властивостями

## Переваги нової системи

### ✅ Автоматичність
- Не потрібно оновлювати код при додаванні продуктів
- Фільтри генеруються автоматично
- Ціни визначаються динамічно

### ✅ Масштабованість
- Легко додавати нові категорії продуктів
- Система адаптується до будь-яких нових властивостей
- Підтримка необмеженої кількості продуктів

### ✅ Зворотна сумісність
- Старі дані продовжують працювати
- Плавний перехід без втрати функціональності
- Fallback на уніфіковані ціни

### ✅ Гнучкість
- Легко додавати нові типи фільтрів
- Можливість кастомізації логіки визначення категорій
- Розширювана архітектура

## Технічні деталі

### Функції утиліт:

- `getUniqueCategories()` - визначає всі категорії
- `getUniqueRootSystems()` - визначає типи кореневої системи
- `getUniqueRootstocks()` - визначає всі підщепи
- `getUniqueRipeningTerms()` - визначає терміни дозрівання
- `getUniqueFrostResistance()` - визначає рівні морозостійкості
- `getUniqueYield()` - визначає рівні врожайності
- `getProductPrice()` - визначає ціну продукту
- `filterProducts()` - фільтрує продукти за критеріями
- `getAllFilterOptions()` - отримує всі опції фільтрів

### Типи даних:

```typescript
export type FilterOptions = {
  rootSystem: string;
  category: string;
  rootstock?: string;
  ripeningTerm?: string;
  frostResistance?: string;
  yieldLevel?: string;
};
```

## Висновок

Система тепер повністю динамічна та готова до масштабування. Додавання нових продуктів не вимагає змін в коді - достатньо просто додати новий об'єкт до масиву `cultivars` у файлі `src/data/products.ts`.
